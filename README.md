# Table of contents 
* [Title](#title)
* [Overview](#overview)
* [Project architecture](#project-architecture)
* [Figures](#figures)
* [Contact](#contact)

# Title
A theoretical framework linking the birth-death and protracted birth-death models, with implications for the phylogenetic analysis of diversification. 

# Overview
Calculation of equivalent birth and death rates under the protracted birth death models.

Simulations and statistics of phylogenies under the protracted 
birth-death (PBD) and BD models following the works from 
> Etienne, R. S., & Rosindell, J. (2012). Prolonging the Past Counteracts the Pull of the Present: Protracted Speciation Can Explain Observed Slowdowns in Diversification. _Systematic Biology, 61_, 204.

> Etienne, R. S., Morlon, H., & Lambert, A. (2014). Estimating the duration of speciation from phylogenies. _Evolution, 68_, 2430–2440.

Test of the analog expressions of birth and death rates from the PBD model. 

# Project architecture
* `1-rates_analysis`: calculate equivalent birth and death rates of the PBD model and analyse these rates. 
* `2-simulate_trees`: simulate trees under
    * the PBD model
    * the BD model with constant rates with equivalent constant rates to the PBD models
    * the BD model with time-dependent rates with equivalent rates to the PBD model 
* `3-compare_PBD_BD_varBD` : compare the trees obtained with the 3 models.
* `4-fit_BD_truncated_PBD_trees` : fits a BD model to truncated phylogenies based on trees simulated with the PBD model.
* `fig` : figures generated by the scripts
* `illustrations` : hand-made figures for the publication
* `modules`: global functions used in the pipeline
* `simulations_output` : raw of the simulations.

# Figures 
The file `customstyle.mplstyle` defines a global style for the Matplotlib figures.
```
# Python
import matplotlib.pyplot as plt
plt.style.use("customstyle.mplstyle")
```

This repository contains the scripts used to generate all the figures in the manuscript. 
| Figure     | File name     | Script to generate |
| ------------- | ------------- | --------------| 
| 1 | `illustrations/schema_horizon.pdf` | `illustrations/schema_horizon.svg` |
| 2 | `illustrations/schema_probas.pdf` | `illustrations/schema_probas.svg` |
| 3 | `fig/PBD_time_dep_rates.pdf` | `1-rates_analysis/1-calculate_probas_rates.ipynb` |
| 4 | `fig/simp_influence_parameters.pdf`  | `1-rates_analysis/4-influence_params_simplifiedPBD.ipynb` | 
| 5 | `fig/statistics_tree.pdf` | `3-compare_PBD_BD_varBD/1-compare_stats.ipynb` | 
| S1 | `fig/SM_probabilities_vs_simulations.pdf` | `1-rates_analysis/1-calculate_probas_rates.ipynb` | 
| S2 | `fig/SM_time_dep_rates_initiation.pdf` | `1-rates_analysis/1-calculate_probas_rates.ipynb`|
| S3 | `fig/SM_time_dep_rates_extinction.pdf` | `1-rates_analysis/1-calculate_probas_rates.ipynb`|
| S4 | `fig/SM_time_dep_rates_comparison_simplified_PBD.pdf` | `2-simulate_trees/3-varBD/1-predict_variable_BD_rates.ipynb` | 
| S5 | `fig/SM_relative_influence_el2.pdf` and `fig/SM_relative_influence_bl2.pdf` | `1-rates_analysis/4-influence_params_simplifiedPBD.ipynb` | 
| S6 | `fig/SM_relative_influence_l1l2.pdf`,  `fig/SM_relative_influence_m2l2.pdf` and `fig/influence_parameters.pdf` | `1-rates_analysis/3-influence_params.ipynb` | 
| S7 | `SM_truncation_lambda.pdf` and `SM_truncation_lambda.pdf` | `4-fit_BD_truncated_PBD_trees\3-plot_comparison.R` |

# Contact
* [Pierre Veron](https://www.ese.universite-paris-saclay.fr/en/team-members/pierre-veron/) (`pierre.veron.2017@polytechnique.org`)
* Jérémy Andréoletti